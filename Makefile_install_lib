# directory containing the repository library files:
CURRYLIBSDIR=$(ROOT)/lib-trunk
CURRYLIBSSRCDIR=$(CURRYLIBSDIR)/src

MODULE_FOLDERS :=$(shell cd $(CURRYLIBSSRCDIR) && find * -type d)
CURRY_FILES    :=$(shell cd $(CURRYLIBSSRCDIR) && find * -name "*.curry")
GHC_FILES      :=$(shell cd $(CURRYLIBSSRCDIR) && find * -name "*.kics2")
GHC_CURRY_FILES:=$(addsuffix .curry, $(basename $(GHC_FILES)))
CURRYONLY_FILES =$(filter-out $(GHC_CURRY_FILES), $(CURRY_FILES))

##########################################################################
# Install the library sources into the Curry system library directory:
.PHONY: install
install: $(MODULE_FOLDERS) $(CURRYONLY_FILES) $(GHC_CURRY_FILES) $(LIBDIR)/Makefile $(LIBDIR)/VERSION

$(MODULE_FOLDERS): %: $(CURRYLIBSSRCDIR)/%
	mkdir -p $@

$(CURRYONLY_FILES): %.curry: $(CURRYLIBSSRCDIR)/%.curry
	cp $< $@

$(GHC_FILES): %.kics2: $(CURRYLIBSSRCDIR)/%.kics2
	cp $< $@

$(GHC_CURRY_FILES): %.curry: $(CURRYLIBSSRCDIR)/%.curry %.kics2
	cp $< $@

$(LIBDIR)/Makefile: $(ROOT)/Makefile_lib
	cp $< $@

$(LIBDIR)/VERSION: $(CURRYLIBSDIR)/VERSION
	cp $< $@
